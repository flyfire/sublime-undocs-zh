<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Syntax Definitions &mdash; Sublime Text Unofficial Documentation  documentation</title>
    
    <link rel="stylesheet" href="../_static/pyramid.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="top" title="Sublime Text Unofficial Documentation  documentation" href="../index.html" />
    <link rel="up" title="Extending Sublime Text" href="extensibility.html" />
    <link rel="next" title="Plugins" href="plugins.html" />
    <link rel="prev" title="Command Palette" href="command_palette.html" />
<link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Neuton&amp;subset=latin" type="text/css" media="screen" charset="utf-8" />
<link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Nobile:regular,italic,bold,bolditalic&amp;subset=latin" type="text/css" media="screen" charset="utf-8" />
<!--[if lte IE 6]>
<link rel="stylesheet" href="../_static/ie6.css" type="text/css" media="screen" charset="utf-8" />
<![endif]-->

  </head>
  <body>

    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="plugins.html" title="Plugins"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="command_palette.html" title="Command Palette"
             accesskey="P">previous</a> |</li>
        <li><a href="../index.html">Sublime Text Unofficial Documentation  documentation</a> &raquo;</li>
          <li><a href="extensibility.html" accesskey="U">Extending Sublime Text</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="syntax-definitions">
<h1>Syntax Definitions<a class="headerlink" href="#syntax-definitions" title="Permalink to this headline">¶</a></h1>
<p>Syntax definitions make Sublime Text aware of programming and markup languages.
Most noticeably, they work together with colors to provide syntax highlighting.
Syntax definitions define <em>scopes</em> that divide the text in a buffer into named
regions. Several editing features in Sublime Text make extensive use of
this fine-grained contextual information.</p>
<p>Essentially, syntax definitions consist of regular expressions used to find
text, as well as more or less arbitrary, dot-separated strings called <em>scopes</em> or <em>scope
names</em>. For every occurrence of a given regular expression, Sublime Text gives
the matching text its corresponding <em>scope name</em>.</p>
<div class="section" id="prerequisites">
<h2>Prerequisites<a class="headerlink" href="#prerequisites" title="Permalink to this headline">¶</a></h2>
<p>In order to follow this tutorial, you will need to install <a class="reference external" href="https://bitbucket.org/guillermooo/aaapackagedev">AAAPackageDev</a>, a package
intended to ease the creation of new syntax definitions for Sublime Text. It
lives in a public <a class="reference external" href="http://mercurial.selenic.com/">Mercurial</a> repository at <a class="reference external" href="http://bitbucket.org">Bitbucket</a>.</p>
<p>Download the latest <tt class="docutils literal"><span class="pre">.sublime-package</span></tt> file and install it as described in
<a class="reference internal" href="packages.html#installation-of-sublime-packages"><em>Installation of .sublime-package Files</em></a>.</p>
<div class="sidebar">
<p class="first sidebar-title">Mercurial and Bitbucket</p>
<p class="last">Mercurial is a distributed version control system (DVCS). Bitbucket is an
online service that provides hosting for Mercurial repositories. If you want
to install Mercurial, there are freely available command-line and graphical
<a class="reference external" href="http://mercurial.selenic.com/downloads/">clients</a>.</p>
</div>
</div>
<div class="section" id="file-format">
<h2>File format<a class="headerlink" href="#file-format" title="Permalink to this headline">¶</a></h2>
<p>Sublime Text uses <a class="reference external" href="http://en.wikipedia.org/wiki/Property_list">property list</a> (Plist) files to store syntax definitions.
However, because editing XML files is a cumbersome task, we&#8217;ll use <a class="reference external" href="http://en.wikipedia.org/wiki/JSON">JSON</a>
instead, and convert it to Plist format afterwards. This is where the
AAAPackageDev package (mentioned above) comes in.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If you experience unexpected errors during this tutorial, chances are
AAAPackageDev is to blame. Don&#8217;t immediately think your problem is due to a
bug in Sublime Text.</p>
</div>
<p>By all means, do edit the Plist files by hand if you prefer to work in XML, but
always keep in mind their differing needs in regards to escape sequences, etc.</p>
</div>
<div class="section" id="scopes">
<span id="scopes-and-scope-selectors"></span><h2>Scopes<a class="headerlink" href="#scopes" title="Permalink to this headline">¶</a></h2>
<p>Scopes are a key concept in Sublime Text. Essentially, they are named text
regions in a buffer. They don&#8217;t do anything by themselves, but Sublime Text peeks
at them when it needs contextual information.</p>
<p>For instance, when you trigger a snippet, Sublime Text checks the scope bound to the
snippet and looks at the caret&#8217;s position in the file. If the caret&#8217;s current
position matches the snippet&#8217;s scope selector, Sublime Text fires it off.
Otherwise, nothing happens.</p>
<div class="sidebar">
<p class="first sidebar-title">Scopes vs Scope Selectors</p>
<p class="last">There&#8217;s a slight difference between <em>scopes</em> and <em>scope selectors</em>: scopes are
the names defined in a syntax definition, while scope selectors are used in
items like snippets and key bindings to target scopes. When creating a new syntax
definition, you care about scopes; when you want to constrain a snippet to a
certain scope, you use a scope selector.</p>
</div>
<p>Scopes can be nested to allow for a high degree of granularity. You can drill down
the hierarchy very much like with CSS selectors. For instance, thanks to scope
selectors, you could have a key binding activated only within single quoted strings
in Python source code, but not inside single quoted strings in any other language.</p>
<p>Sublime Text inherits the idea of scopes from Textmate, a text editor for Mac.
<a class="reference external" href="http://manual.macromates.com/en/">Textmate&#8217;s online manual</a> contains further information about scope selectors
that&#8217;s useful for Sublime Text users too.</p>
</div>
<div class="section" id="how-syntax-definitions-work">
<h2>How Syntax Definitions Work<a class="headerlink" href="#how-syntax-definitions-work" title="Permalink to this headline">¶</a></h2>
<p>At their core, syntax definitions are arrays of regular expressions paired with
scope names. Sublime Text will try to match these patterns against a buffer&#8217;s text
and attach the corresponding scope name to all occurrences. These pairs of regular
expressions and scope names are known as <em>rules</em>.</p>
<p>Rules are applied in order, one line at a time. Each rule consumes the matched
text region, which therefore will be excluded from the next rule&#8217;s matching attempt
(save for a few exceptions). In practical terms, this means that you should take
care to go from more specific rules to more general ones when you create a new
syntax definition. Otherwise, a greedy regular expression might swallow parts
you&#8217;d like to have styled differently.</p>
<p>Syntax definitions from separate files can be combined, and they can be recursively
applied too.</p>
</div>
<div class="section" id="your-first-syntax-definition">
<h2>Your First Syntax Definition<a class="headerlink" href="#your-first-syntax-definition" title="Permalink to this headline">¶</a></h2>
<p>By way of example, let&#8217;s create a syntax definition for Sublime Text snippets.
We&#8217;ll be styling the actual snippet content, not the <tt class="docutils literal"><span class="pre">.sublime-snippet</span></tt> file.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Since syntax definitions are primarily used to enable syntax highlighting,
we&#8217;ll use the phrase <em>to style</em> to mean <em>to break down a source code file into
scopes</em>. Keep in mind, however, that colors are a different thing from syntax
definitions and that scopes have many more uses besides syntax highlighting.</p>
</div>
<p>Here are the elements we want to style in a snippet:</p>
<blockquote>
<div><ul class="simple">
<li>Variables (<tt class="docutils literal"><span class="pre">$PARAM1</span></tt>, <tt class="docutils literal"><span class="pre">$USER_NAME</span></tt>...)</li>
<li>Simple fields (<tt class="docutils literal"><span class="pre">$0</span></tt>, <tt class="docutils literal"><span class="pre">$1</span></tt>...)</li>
<li>Complex fields with placeholders (<tt class="docutils literal"><span class="pre">${1:Hello}</span></tt>)</li>
<li>Nested fields (<tt class="docutils literal"><span class="pre">${1:Hello</span> <span class="pre">${2:World}!}</span></tt>)</li>
<li>Escape sequences (<tt class="docutils literal"><span class="pre">\\$</span></tt>, <tt class="docutils literal"><span class="pre">\\&lt;</span></tt>...)</li>
<li>Illegal sequences (<tt class="docutils literal"><span class="pre">$</span></tt>, <tt class="docutils literal"><span class="pre">&lt;</span></tt>...)</li>
</ul>
</div></blockquote>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Before continuing, make sure you&#8217;ve installed the AAAPackageDev package
as explained above.</p>
</div>
<div class="section" id="creating-a-new-syntax-definition">
<h3>Creating A New Syntax Definition<a class="headerlink" href="#creating-a-new-syntax-definition" title="Permalink to this headline">¶</a></h3>
<p>To create a new syntax definition, follow these steps:</p>
<blockquote>
<div><ul class="simple">
<li>Go to <strong>Tools | Packages | Package Development | New Syntax Definition</strong></li>
<li>Save the new file in your <tt class="docutils literal"><span class="pre">Packages/User</span></tt> folder as a <tt class="docutils literal"><span class="pre">.JSON-tmLanguage</span></tt> file.</li>
</ul>
</div></blockquote>
<p>You now should see a file like this:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="p">{</span> <span class="s">&quot;name&quot;</span><span class="p">:</span> <span class="s">&quot;Syntax Name&quot;</span><span class="p">,</span>
  <span class="s">&quot;scopeName&quot;</span><span class="p">:</span> <span class="s">&quot;source.syntax_name&quot;</span><span class="p">,</span>
  <span class="s">&quot;fileTypes&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s">&quot;&quot;</span><span class="p">],</span>
  <span class="s">&quot;patterns&quot;</span><span class="p">:</span> <span class="p">[</span>
  <span class="p">],</span>
  <span class="s">&quot;uuid&quot;</span><span class="p">:</span> <span class="s">&quot;ca03e751-04ef-4330-9a6b-9b99aae1c418&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Let&#8217;s examine now the key elements.</p>
<dl class="docutils">
<dt><tt class="docutils literal"><span class="pre">uuid</span></tt></dt>
<dd>Located at the end, this is a unique identifier for this syntax definition.
Each new syntax definition gets its own uuid. Don&#8217;t modify them.</dd>
<dt><tt class="docutils literal"><span class="pre">name</span></tt></dt>
<dd>The name that Sublime Text will display in the syntax definition drop-down list.
Use a short, descriptive name. Typically, you will use the name of the programming
language you are creating the syntax definition for.</dd>
<dt><tt class="docutils literal"><span class="pre">scopeName</span></tt></dt>
<dd>The top level scope for this syntax definition. It takes the form
<tt class="docutils literal"><span class="pre">source.&lt;lang_name&gt;</span></tt> or <tt class="docutils literal"><span class="pre">text.&lt;lang_name&gt;</span></tt>. For programming languages,
use <tt class="docutils literal"><span class="pre">source</span></tt>. For markup and everything else, use <tt class="docutils literal"><span class="pre">text</span></tt>.</dd>
<dt><tt class="docutils literal"><span class="pre">fileTypes</span></tt></dt>
<dd>This is a list of file extensions. When opening files of these types,
Sublime Text will automatically activate this syntax definition for them.</dd>
<dt><tt class="docutils literal"><span class="pre">patterns</span></tt></dt>
<dd>A container for your patterns.</dd>
</dl>
<p>For our example, fill the template with the following information:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="p">{</span>   <span class="s">&quot;name&quot;</span><span class="p">:</span> <span class="s">&quot;Sublime Snippet (Raw)&quot;</span><span class="p">,</span>
    <span class="s">&quot;scopeName&quot;</span><span class="p">:</span> <span class="s">&quot;source.ssraw&quot;</span><span class="p">,</span>
    <span class="s">&quot;fileTypes&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s">&quot;ssraw&quot;</span><span class="p">],</span>
    <span class="s">&quot;patterns&quot;</span><span class="p">:</span> <span class="p">[</span>
    <span class="p">],</span>
    <span class="s">&quot;uuid&quot;</span><span class="p">:</span> <span class="s">&quot;ca03e751-04ef-4330-9a6b-9b99aae1c418&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">JSON is a very strict format, so make sure to get all the commas and quotes right.
If the conversion to Plist fails, take a look at the output panel for more
information on the error. We&#8217;ll explain later how to convert a syntax
definition in JSON to Plist.</p>
</div>
</div>
</div>
<div class="section" id="analyzing-patterns">
<h2>Analyzing Patterns<a class="headerlink" href="#analyzing-patterns" title="Permalink to this headline">¶</a></h2>
<p>The <tt class="docutils literal"><span class="pre">patterns</span></tt> array can contain several types of elements. We&#8217;ll look at some
of them in the following sections. If you want to learn more about patterns,
refer to Textmate&#8217;s online manual.</p>
<div class="sidebar">
<p class="first sidebar-title">Regular Expressions&#8217; Syntax In Syntax Definitions</p>
<p class="last">Sublime Text uses <a class="reference external" href="http://www.geocities.jp/kosako3/oniguruma/doc/RE.txt">Oniguruma</a>&#8216;s syntax for regular expressions in syntax definitions.
Several existing syntax definitions make use of features supported by this regular
expression engine that aren&#8217;t part of perl-style regular expressions, hence the
requirement for Oniguruma.</p>
</div>
<div class="section" id="matches">
<h3>Matches<a class="headerlink" href="#matches" title="Permalink to this headline">¶</a></h3>
<p>Matches take this form:</p>
<div class="highlight-js"><div class="highlight"><pre><span class="p">{</span> <span class="s2">&quot;match&quot;</span><span class="o">:</span> <span class="s2">&quot;[Mm]y \s+[Rr]egex&quot;</span><span class="p">,</span>
  <span class="s2">&quot;name&quot;</span><span class="o">:</span> <span class="s2">&quot;string.ssraw&quot;</span><span class="p">,</span>
  <span class="s2">&quot;comment&quot;</span><span class="o">:</span> <span class="s2">&quot;This comment is optional.&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<dl class="docutils">
<dt><tt class="docutils literal"><span class="pre">match</span></tt></dt>
<dd>A regular expression Sublime Text will use to find matches.</dd>
<dt><tt class="docutils literal"><span class="pre">name</span></tt></dt>
<dd>The name of the scope that should be applied to any occurrences of <tt class="docutils literal"><span class="pre">match</span></tt>.</dd>
<dt><tt class="docutils literal"><span class="pre">comment</span></tt></dt>
<dd>An optional comment about this pattern.</dd>
</dl>
<p>Let&#8217;s go back to our example. Make it look like this:</p>
<div class="highlight-js"><div class="highlight"><pre><span class="p">{</span> <span class="s2">&quot;name&quot;</span><span class="o">:</span> <span class="s2">&quot;Sublime Snippet (Raw)&quot;</span><span class="p">,</span>
  <span class="s2">&quot;scopeName&quot;</span><span class="o">:</span> <span class="s2">&quot;source.ssraw&quot;</span><span class="p">,</span>
  <span class="s2">&quot;fileTypes&quot;</span><span class="o">:</span> <span class="p">[</span><span class="s2">&quot;ssraw&quot;</span><span class="p">],</span>
  <span class="s2">&quot;patterns&quot;</span><span class="o">:</span> <span class="p">[</span>
  <span class="p">],</span>
  <span class="s2">&quot;uuid&quot;</span><span class="o">:</span> <span class="s2">&quot;ca03e751-04ef-4330-9a6b-9b99aae1c418&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>That is, make sure the <tt class="docutils literal"><span class="pre">patterns</span></tt> array is empty.</p>
<p>Now we can begin to add our rules for Sublime snippets. Let&#8217;s start with simple
fields. These could be matched with a regex like so:</p>
<div class="highlight-perl"><pre>\$[0-9]+
# or...
\$\d+</pre>
</div>
<p>However, because we&#8217;re writing our regex in JSON, we need to factor in JSON&#8217;s
own escaping rules. Thus, our previous example becomes:</p>
<div class="highlight-js"><pre>\\$\\d+</pre>
</div>
<p>With escaping out of the way, we can build our pattern like this:</p>
<div class="highlight-js"><div class="highlight"><pre><span class="p">{</span> <span class="s2">&quot;match&quot;</span><span class="o">:</span> <span class="s2">&quot;\\$\\d+&quot;</span><span class="p">,</span>
  <span class="s2">&quot;name&quot;</span><span class="o">:</span> <span class="s2">&quot;keyword.source.ssraw&quot;</span><span class="p">,</span>
  <span class="s2">&quot;comment&quot;</span><span class="o">:</span> <span class="s2">&quot;Tab stops like $1, $2...&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="sidebar">
<p class="first sidebar-title">Choosing the Right Scope Name</p>
<p>Naming scopes isn&#8217;t obvious sometimes. Check the Textmate online manual
for guidance on scope names. It is important to re-use the basic categories
outlined there if you want to achieve the highest compatibility with existing
colors.</p>
<p>Colors have hardcoded scope names in them. They could not possibly include
every scope name you can think of, so they target the standard ones plus some
rarer ones on occasion. This means that two colors using the same syntax
definition may render the text differently!</p>
<p class="last">Bear in mind too that you should use the scope name that best suits your
needs or preferences. It&#8217;d be perfectly fine to assign a scope like
<tt class="docutils literal"><span class="pre">constant.numeric</span></tt> to anything other than a number if you have a good
reason to do so.</p>
</div>
<p>And we can add it to our syntax definition too:</p>
<div class="highlight-js"><div class="highlight"><pre><span class="p">{</span>   <span class="s2">&quot;name&quot;</span><span class="o">:</span> <span class="s2">&quot;Sublime Snippet (Raw)&quot;</span><span class="p">,</span>
    <span class="s2">&quot;scopeName&quot;</span><span class="o">:</span> <span class="s2">&quot;source.ssraw&quot;</span><span class="p">,</span>
    <span class="s2">&quot;fileTypes&quot;</span><span class="o">:</span> <span class="p">[</span><span class="s2">&quot;ssraw&quot;</span><span class="p">],</span>
    <span class="s2">&quot;patterns&quot;</span><span class="o">:</span> <span class="p">[</span>
        <span class="p">{</span> <span class="s2">&quot;match&quot;</span><span class="o">:</span> <span class="s2">&quot;\\$\\d+&quot;</span><span class="p">,</span>
          <span class="s2">&quot;name&quot;</span><span class="o">:</span> <span class="s2">&quot;keyword.source.ssraw&quot;</span><span class="p">,</span>
          <span class="s2">&quot;comment&quot;</span><span class="o">:</span> <span class="s2">&quot;Tab stops like $1, $2...&quot;</span>
        <span class="p">}</span>
    <span class="p">],</span>
    <span class="s2">&quot;uuid&quot;</span><span class="o">:</span> <span class="s2">&quot;ca03e751-04ef-4330-9a6b-9b99aae1c418&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>We&#8217;re now ready to convert our file to <tt class="docutils literal"><span class="pre">.tmLanguage</span></tt>. Syntax definitions use
Textmate&#8217;s <tt class="docutils literal"><span class="pre">.tmLanguage</span></tt> extension for compatibility reasons. As explained
above, they are simply XML files, but in Plist format.</p>
<p>Follow these steps to perform the conversion:</p>
<blockquote>
<div><ul class="simple">
<li>Select <tt class="docutils literal"><span class="pre">Json</span> <span class="pre">to</span> <span class="pre">tmLanguage</span></tt> in <strong>Tools | Build System</strong></li>
<li>Press <tt class="kbd docutils literal"><span class="pre">F7</span></tt></li>
<li>A <tt class="docutils literal"><span class="pre">.tmLanguage</span></tt> file will be generated for you in the same folder as your
<tt class="docutils literal"><span class="pre">.JSON-tmLanguage</span></tt> file</li>
<li>Sublime Text will reload the changes to the syntax definition</li>
</ul>
</div></blockquote>
<p>You have now created your first syntax definition. Next, open a new file and save
it with the extension <tt class="docutils literal"><span class="pre">.ssraw</span></tt>. The buffer&#8217;s syntax name should switch to
&#8220;Sublime Snippet (Raw)&#8221; automatically, and you should get syntax highlighting if
you type <tt class="docutils literal"><span class="pre">$1</span></tt> or any other simple snippet field.</p>
<p>Let&#8217;s proceed to creating another rule for environment variables.</p>
<div class="highlight-js"><div class="highlight"><pre><span class="p">{</span> <span class="s2">&quot;match&quot;</span><span class="o">:</span> <span class="s2">&quot;\\$[A-Za-z][A-Za-z0-9_]+&quot;</span><span class="p">,</span>
  <span class="s2">&quot;name&quot;</span><span class="o">:</span> <span class="s2">&quot;keyword.source.ssraw&quot;</span><span class="p">,</span>
  <span class="s2">&quot;comment&quot;</span><span class="o">:</span> <span class="s2">&quot;Variables like $PARAM1, $TM_SELECTION...&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Repeat the above steps to update the <tt class="docutils literal"><span class="pre">.tmLanguage</span></tt> file, and restart Sublime Text.</p>
</div>
<div class="section" id="fine-tuning-matches">
<h3>Fine Tuning Matches<a class="headerlink" href="#fine-tuning-matches" title="Permalink to this headline">¶</a></h3>
<p>You might have noticed, for instance, that the entire text in <tt class="docutils literal"><span class="pre">$PARAM1</span></tt> is styled
the same way. Depending on your needs or your personal preferences, you may want
the <tt class="docutils literal"><span class="pre">$</span></tt> to stand out. That&#8217;s where <tt class="docutils literal"><span class="pre">captures</span></tt> come in. Using captures,
you can break a pattern down into components to target them individually.</p>
<p>Let&#8217;s rewrite one of our previous patterns to use <tt class="docutils literal"><span class="pre">captures</span></tt>:</p>
<div class="highlight-js"><div class="highlight"><pre><span class="p">{</span> <span class="s2">&quot;match&quot;</span><span class="o">:</span> <span class="s2">&quot;\\$([A-Za-z][A-Za-z0-9_]+)&quot;</span><span class="p">,</span>
  <span class="s2">&quot;name&quot;</span><span class="o">:</span> <span class="s2">&quot;keyword.ssraw&quot;</span><span class="p">,</span>
  <span class="s2">&quot;captures&quot;</span><span class="o">:</span> <span class="p">{</span>
      <span class="s2">&quot;1&quot;</span><span class="o">:</span> <span class="p">{</span> <span class="s2">&quot;name&quot;</span><span class="o">:</span> <span class="s2">&quot;constant.numeric.ssraw&quot;</span> <span class="p">}</span>
   <span class="p">},</span>
  <span class="s2">&quot;comment&quot;</span><span class="o">:</span> <span class="s2">&quot;Variables like $PARAM1, $TM_SELECTION...&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Captures introduce complexity to your rule, but they are pretty straightforward.
Notice how numbers refer to parenthesized groups left to right. Of course, you can
have as many capture groups as you want.</p>
<p>Arguably, you&#8217;d want the other scope to be visually consistent with this one.
Go ahead and change it too.</p>
</div>
<div class="section" id="begin-end-rules">
<h3>Begin-End Rules<a class="headerlink" href="#begin-end-rules" title="Permalink to this headline">¶</a></h3>
<p>Up to now we&#8217;ve been using a simple rule. Although we&#8217;ve seen how to dissect patterns
into smaller components, sometimes you&#8217;ll want to target a larger portion of your
source code that is clearly delimited by start and end marks.</p>
<p>Literal strings enclosed by quotation marks or other delimiting constructs are
better dealt with by begin-end rules. This is a skeleton for one of these rules:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="p">{</span> <span class="s">&quot;name&quot;</span><span class="p">:</span> <span class="s">&quot;&quot;</span><span class="p">,</span>
  <span class="s">&quot;begin&quot;</span><span class="p">:</span> <span class="s">&quot;&quot;</span><span class="p">,</span>
  <span class="s">&quot;end&quot;</span><span class="p">:</span> <span class="s">&quot;&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Well, at least in their simplest version. Let&#8217;s take a look at one that
includes all available options:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="p">{</span> <span class="s">&quot;name&quot;</span><span class="p">:</span> <span class="s">&quot;&quot;</span><span class="p">,</span>
  <span class="s">&quot;begin&quot;</span><span class="p">:</span> <span class="s">&quot;&quot;</span><span class="p">,</span>
  <span class="s">&quot;beginCaptures&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s">&quot;0&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="s">&quot;name&quot;</span><span class="p">:</span> <span class="s">&quot;&quot;</span> <span class="p">}</span>
  <span class="p">},</span>
  <span class="s">&quot;end&quot;</span><span class="p">:</span> <span class="s">&quot;&quot;</span><span class="p">,</span>
  <span class="s">&quot;endCaptures&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s">&quot;0&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="s">&quot;name&quot;</span><span class="p">:</span> <span class="s">&quot;&quot;</span> <span class="p">}</span>
  <span class="p">},</span>
  <span class="s">&quot;patterns&quot;</span><span class="p">:</span> <span class="p">[</span>
     <span class="p">{</span>  <span class="s">&quot;name&quot;</span><span class="p">:</span> <span class="s">&quot;&quot;</span><span class="p">,</span>
        <span class="s">&quot;match&quot;</span><span class="p">:</span> <span class="s">&quot;&quot;</span>
                  <span class="p">}</span>
  <span class="p">],</span>
  <span class="s">&quot;contentName&quot;</span><span class="p">:</span> <span class="s">&quot;&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Some elements may look familiar, but their combination might be daunting. Let&#8217;s
see them individually.</p>
<dl class="docutils">
<dt><tt class="docutils literal"><span class="pre">begin</span></tt></dt>
<dd>Regex for the opening mark for this scope.</dd>
<dt><tt class="docutils literal"><span class="pre">end</span></tt></dt>
<dd>Regex for the end mark for this scope.</dd>
<dt><tt class="docutils literal"><span class="pre">beginCaptures</span></tt></dt>
<dd>Captures for the <tt class="docutils literal"><span class="pre">begin</span></tt> marker. They work like captures for simple matches. Optional.</dd>
<dt><tt class="docutils literal"><span class="pre">endCaptures</span></tt></dt>
<dd>Same as <tt class="docutils literal"><span class="pre">beginCaptures</span></tt> but for the <tt class="docutils literal"><span class="pre">end</span></tt> marker. Optional.</dd>
<dt><tt class="docutils literal"><span class="pre">contentName</span></tt></dt>
<dd>Scope for the whole matched region, from the begin marker to the end marker
(inclusive). Effectively, this will create nested scopes for <tt class="docutils literal"><span class="pre">beginCaptures</span></tt>,
<tt class="docutils literal"><span class="pre">endCaptures</span></tt> and <tt class="docutils literal"><span class="pre">patterns</span></tt> defined within this rule. Optional.</dd>
<dt><tt class="docutils literal"><span class="pre">patterns</span></tt></dt>
<dd>An array of patterns to match <strong>only</strong> against the begin-end&#8217;s content&#8212;they aren&#8217;t
matched against the text consumed by <tt class="docutils literal"><span class="pre">begin</span></tt> or <tt class="docutils literal"><span class="pre">end</span></tt> themselves.</dd>
</dl>
<p>We&#8217;ll use this rule to style nested complex fields in snippets:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="p">{</span> <span class="s">&quot;name&quot;</span><span class="p">:</span> <span class="s">&quot;variable.complex.ssraw&quot;</span><span class="p">,</span>
   <span class="s">&quot;begin&quot;</span><span class="p">:</span> <span class="s">&quot;(</span><span class="se">\\</span><span class="s">$)(</span><span class="se">\\</span><span class="s">{)([0-9]+):&quot;</span><span class="p">,</span>
   <span class="s">&quot;beginCaptures&quot;</span><span class="p">:</span> <span class="p">{</span>
       <span class="s">&quot;1&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="s">&quot;name&quot;</span><span class="p">:</span> <span class="s">&quot;keyword.ssraw&quot;</span> <span class="p">},</span>
       <span class="s">&quot;3&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="s">&quot;name&quot;</span><span class="p">:</span> <span class="s">&quot;constant.numeric.ssraw&quot;</span> <span class="p">}</span>
   <span class="p">},</span>
   <span class="s">&quot;patterns&quot;</span><span class="p">:</span> <span class="p">[</span>
       <span class="p">{</span> <span class="s">&quot;include&quot;</span><span class="p">:</span> <span class="s">&quot;$self&quot;</span> <span class="p">},</span>
       <span class="p">{</span>  <span class="s">&quot;name&quot;</span><span class="p">:</span> <span class="s">&quot;string.ssraw&quot;</span><span class="p">,</span>
          <span class="s">&quot;match&quot;</span><span class="p">:</span> <span class="s">&quot;.&quot;</span>
       <span class="p">}</span>
   <span class="p">],</span>
   <span class="s">&quot;end&quot;</span><span class="p">:</span> <span class="s">&quot;</span><span class="se">\\</span><span class="s">}&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>This is the most complex pattern we&#8217;ll see in this tutorial. The <tt class="docutils literal"><span class="pre">begin</span></tt> and <tt class="docutils literal"><span class="pre">end</span></tt>
keys are self-explanatory: they define a region enclosed between <tt class="docutils literal"><span class="pre">${&lt;NUMBER&gt;:</span></tt> and <tt class="docutils literal"><span class="pre">}</span></tt>.
<tt class="docutils literal"><span class="pre">beginCaptures</span></tt> further divides the begin mark into smaller scopes.</p>
<p>The most interesting part, however, is <tt class="docutils literal"><span class="pre">patterns</span></tt>. Recursion, and the
importance of ordering, have finally made their appearance here.</p>
<p>We&#8217;ve seen above that fields can be nested. In order to account for this, we
need to style nested fields recursively. That&#8217;s what the <tt class="docutils literal"><span class="pre">include</span></tt> rule does
when we furnish it the <tt class="docutils literal"><span class="pre">$self</span></tt> value: it recursively applies our entire
syntax definition the text captured by our begin-end rule. This portion
excludes the text individually consumed by the regexes for <tt class="docutils literal"><span class="pre">begin</span></tt> and
<tt class="docutils literal"><span class="pre">end</span></tt>.</p>
<p>Remember, matched text is consumed; thus, it is excluded from the next match attempt.</p>
<p>To finish off complex fields, we&#8217;ll style placeholders as strings. Since
we&#8217;ve already matched all possible tokens inside a complex field, we can
safely tell Sublime Text to give any remaining text (<tt class="docutils literal"><span class="pre">.</span></tt>) a literal string scope.</p>
</div>
<div class="section" id="final-touches">
<h3>Final Touches<a class="headerlink" href="#final-touches" title="Permalink to this headline">¶</a></h3>
<p>Lastly, let&#8217;s style escape sequences and illegal sequences, and then we can wrap up.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="p">{</span>  <span class="s">&quot;name&quot;</span><span class="p">:</span> <span class="s">&quot;constant.character.escape.ssraw&quot;</span><span class="p">,</span>
   <span class="s">&quot;match&quot;</span><span class="p">:</span> <span class="s">&quot;</span><span class="se">\\\\</span><span class="s">(</span><span class="se">\\</span><span class="s">$|</span><span class="se">\\</span><span class="s">&gt;|</span><span class="se">\\</span><span class="s">&lt;)&quot;</span>
<span class="p">},</span>

<span class="p">{</span>  <span class="s">&quot;name&quot;</span><span class="p">:</span> <span class="s">&quot;invalid.ssraw&quot;</span><span class="p">,</span>
   <span class="s">&quot;match&quot;</span><span class="p">:</span> <span class="s">&quot;(</span><span class="se">\\</span><span class="s">$|</span><span class="se">\\</span><span class="s">&lt;|</span><span class="se">\\</span><span class="s">&gt;)&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The only hard thing here is getting the number of escape characters right. Other
than that, the rules are pretty straightforward if you&#8217;re familiar with
regular expressions.</p>
<p>However, you must take care to place the second rule after any others matching
the <tt class="docutils literal"><span class="pre">$</span></tt> character, since otherwise you may not get the desired results.</p>
<p>Also, even after adding these two additional rules, note that our recursive
begin-end rule from above continues to work as expected.</p>
<p>At long last, here&#8217;s the final syntax definition:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="p">{</span>   <span class="s">&quot;name&quot;</span><span class="p">:</span> <span class="s">&quot;Sublime Snippet (Raw)&quot;</span><span class="p">,</span>
    <span class="s">&quot;scopeName&quot;</span><span class="p">:</span> <span class="s">&quot;source.ssraw&quot;</span><span class="p">,</span>
    <span class="s">&quot;fileTypes&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s">&quot;ssraw&quot;</span><span class="p">],</span>
    <span class="s">&quot;patterns&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span> <span class="s">&quot;match&quot;</span><span class="p">:</span> <span class="s">&quot;</span><span class="se">\\</span><span class="s">$(</span><span class="se">\\</span><span class="s">d+)&quot;</span><span class="p">,</span>
          <span class="s">&quot;name&quot;</span><span class="p">:</span> <span class="s">&quot;keyword.ssraw&quot;</span><span class="p">,</span>
          <span class="s">&quot;captures&quot;</span><span class="p">:</span> <span class="p">{</span>
              <span class="s">&quot;1&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="s">&quot;name&quot;</span><span class="p">:</span> <span class="s">&quot;constant.numeric.ssraw&quot;</span> <span class="p">}</span>
           <span class="p">},</span>
          <span class="s">&quot;comment&quot;</span><span class="p">:</span> <span class="s">&quot;Tab stops like $1, $2...&quot;</span>
        <span class="p">},</span>

        <span class="p">{</span> <span class="s">&quot;match&quot;</span><span class="p">:</span> <span class="s">&quot;</span><span class="se">\\</span><span class="s">$([A-Za-z][A-Za-z0-9_]+)&quot;</span><span class="p">,</span>
          <span class="s">&quot;name&quot;</span><span class="p">:</span> <span class="s">&quot;keyword.ssraw&quot;</span><span class="p">,</span>
          <span class="s">&quot;captures&quot;</span><span class="p">:</span> <span class="p">{</span>
              <span class="s">&quot;1&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="s">&quot;name&quot;</span><span class="p">:</span> <span class="s">&quot;constant.numeric.ssraw&quot;</span> <span class="p">}</span>
           <span class="p">},</span>
          <span class="s">&quot;comment&quot;</span><span class="p">:</span> <span class="s">&quot;Variables like $PARAM1, $TM_SELECTION...&quot;</span>
        <span class="p">},</span>

        <span class="p">{</span> <span class="s">&quot;name&quot;</span><span class="p">:</span> <span class="s">&quot;variable.complex.ssraw&quot;</span><span class="p">,</span>
          <span class="s">&quot;begin&quot;</span><span class="p">:</span> <span class="s">&quot;(</span><span class="se">\\</span><span class="s">$)(</span><span class="se">\\</span><span class="s">{)([0-9]+):&quot;</span><span class="p">,</span>
          <span class="s">&quot;beginCaptures&quot;</span><span class="p">:</span> <span class="p">{</span>
              <span class="s">&quot;1&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="s">&quot;name&quot;</span><span class="p">:</span> <span class="s">&quot;keyword.ssraw&quot;</span> <span class="p">},</span>
              <span class="s">&quot;3&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="s">&quot;name&quot;</span><span class="p">:</span> <span class="s">&quot;constant.numeric.ssraw&quot;</span> <span class="p">}</span>
           <span class="p">},</span>
           <span class="s">&quot;patterns&quot;</span><span class="p">:</span> <span class="p">[</span>
              <span class="p">{</span> <span class="s">&quot;include&quot;</span><span class="p">:</span> <span class="s">&quot;$self&quot;</span> <span class="p">},</span>
              <span class="p">{</span> <span class="s">&quot;name&quot;</span><span class="p">:</span> <span class="s">&quot;string.ssraw&quot;</span><span class="p">,</span>
                <span class="s">&quot;match&quot;</span><span class="p">:</span> <span class="s">&quot;.&quot;</span>
              <span class="p">}</span>
           <span class="p">],</span>
           <span class="s">&quot;end&quot;</span><span class="p">:</span> <span class="s">&quot;</span><span class="se">\\</span><span class="s">}&quot;</span>
        <span class="p">},</span>

        <span class="p">{</span> <span class="s">&quot;name&quot;</span><span class="p">:</span> <span class="s">&quot;constant.character.escape.ssraw&quot;</span><span class="p">,</span>
          <span class="s">&quot;match&quot;</span><span class="p">:</span> <span class="s">&quot;</span><span class="se">\\\\</span><span class="s">(</span><span class="se">\\</span><span class="s">$|</span><span class="se">\\</span><span class="s">&gt;|</span><span class="se">\\</span><span class="s">&lt;)&quot;</span>
        <span class="p">},</span>

        <span class="p">{</span> <span class="s">&quot;name&quot;</span><span class="p">:</span> <span class="s">&quot;invalid.ssraw&quot;</span><span class="p">,</span>
          <span class="s">&quot;match&quot;</span><span class="p">:</span> <span class="s">&quot;(</span><span class="se">\\</span><span class="s">$|</span><span class="se">\\</span><span class="s">&gt;|</span><span class="se">\\</span><span class="s">&lt;)&quot;</span>
        <span class="p">}</span>
    <span class="p">],</span>
    <span class="s">&quot;uuid&quot;</span><span class="p">:</span> <span class="s">&quot;ca03e751-04ef-4330-9a6b-9b99aae1c418&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>There are more available constructs and code reuse techniques, but the above
explanations should get you started with the creation of syntax definitions.</p>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Syntax Definitions</a><ul>
<li><a class="reference internal" href="#prerequisites">Prerequisites</a></li>
<li><a class="reference internal" href="#file-format">File format</a></li>
<li><a class="reference internal" href="#scopes">Scopes</a></li>
<li><a class="reference internal" href="#how-syntax-definitions-work">How Syntax Definitions Work</a></li>
<li><a class="reference internal" href="#your-first-syntax-definition">Your First Syntax Definition</a><ul>
<li><a class="reference internal" href="#creating-a-new-syntax-definition">Creating A New Syntax Definition</a></li>
</ul>
</li>
<li><a class="reference internal" href="#analyzing-patterns">Analyzing Patterns</a><ul>
<li><a class="reference internal" href="#matches">Matches</a></li>
<li><a class="reference internal" href="#fine-tuning-matches">Fine Tuning Matches</a></li>
<li><a class="reference internal" href="#begin-end-rules">Begin-End Rules</a></li>
<li><a class="reference internal" href="#final-touches">Final Touches</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="command_palette.html"
                        title="previous chapter">Command Palette</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="plugins.html"
                        title="next chapter">Plugins</a></p>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="plugins.html" title="Plugins"
             >next</a> |</li>
        <li class="right" >
          <a href="command_palette.html" title="Command Palette"
             >previous</a> |</li>
        <li><a href="../index.html">Sublime Text Unofficial Documentation  documentation</a> &raquo;</li>
          <li><a href="extensibility.html" >Extending Sublime Text</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2013, Chinese by baiting, Author:guillermooo.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2b2.
    </div>
  </body>
</html>